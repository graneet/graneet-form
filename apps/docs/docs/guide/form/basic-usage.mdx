import { IFrame } from "../../../src/components/IFrame";

# Basic Usage

Get started with `graneet-form` by learning the fundamental concepts and creating your first form.

## Quick Start

Here's a simple example to get you started:

```tsx
import { useForm, Form, Field, Rule } from 'graneet-form';

interface ContactForm {
  name: string;
  email: string;
}

function ContactFormExample() {
  const form = useForm<ContactForm>({
    defaultValues: {
      name: '',
      email: ''
    }
  });

  const handleSubmit = form.handleSubmit(async (data) => {
    console.log('Form submitted:', data);
    // Process form data
  });

  return (
  <Form form={form} onSubmit={handleSubmit}>
    <div>
      <label>Name:</label>
      <Field<ContactForm, 'name'>
        name="name"
        render={(fieldProps, fieldState) => (
          <div>
            <input
              type="text"
              value={fieldProps.value || ''}
              onChange={(e) => fieldProps.onChange(e.target.value)}
              onBlur={fieldProps.onBlur}
              onFocus={fieldProps.onFocus}
            />
            {!fieldState.isPristine && fieldState.validationStatus.status === 'invalid' && (
              <span style={{ color: 'red' }}>
                {fieldState.validationStatus.message}
              </span>
            )}
          </div>
        )}
      >
        <Rule
          validationFn={(value) => !!value && value.length > 0}
          message="Name is required"
        />
      </Field>
    </div>

    <div>
      <label>Email:</label>
      <Field<ContactForm, 'email'>
        name="email"
        render={(fieldProps, fieldState) => (
          <div>
            <input
              type="email"
              value={fieldProps.value || ''}
              onChange={(e) => fieldProps.onChange(e.target.value)}
              onBlur={fieldProps.onBlur}
              onFocus={fieldProps.onFocus}
            />
            {!fieldState.isPristine && fieldState.validationStatus.status === 'invalid' && (
              <span style={{ color: 'red' }}>
                {fieldState.validationStatus.message}
              </span>
            )}
          </div>
        )}
      >
        <Rule
          validationFn={(value) => !!value && value.includes('@')}
          message="Please enter a valid email"
        />
      </Field>
    </div>

    <button type="submit">Submit</button>
  </Form>
  );
}
```

## Core Components

### 1. `useForm` Hook

The `useForm` hook is the entry point for creating a form. It returns a form instance that manages all form state.

```tsx
const form = useForm<FormDataType>({
  defaultValues: {
    // Initial values for your fields
  }
});
```

### 2. `Form` Component

Wraps your form fields and provides the form context to all child components.

```tsx
<Form form={form}>
  {/* Your form fields go here */}
</Form>
```

### 3. `Field` Component

Registers individual form fields and handles their state management.

```tsx
<Field<FormType, 'fieldName'>
  name="fieldName"
  render={(fieldProps, fieldState) => (
    <input
      value={fieldProps.value || ''}
      onChange={(e) => fieldProps.onChange(e.target.value)}
      onBlur={fieldProps.onBlur}
      onFocus={fieldProps.onFocus}
    />
  )}
/>
```

### 4. `Rule` Component

Adds validation rules to fields.

```tsx
<Rule
  validationFn={(value) => /* validation logic */}
  message="Error message when validation fails"
/>
```

## Live Example

<IFrame model="simple-form" />

## Field Props and State

### Field Props (`fieldProps`)

The render function receives `fieldProps` with the following properties:

- `name`: The field name
- `value`: Current field value
- `onChange(value)`: Function to update the field value
- `onBlur()`: Function to call when field loses focus
- `onFocus()`: Function to call when field gains focus

### Field State (`fieldState`)

The render function also receives `fieldState` with:

- `isPristine`: `true` if the field hasn't been focused/modified yet
- `validationStatus`: Object containing validation status and message
  - `status`: `'valid'`, `'invalide'`, or `'pending'`
  - `message`: Error message if validation failed

## Simple Form Patterns

### Text Input

```tsx
<Field<FormType, 'username'>
  name="username"
  render={(fieldProps) => (
    <input
      type="text"
      placeholder="Enter username"
      value={fieldProps.value || ''}
      onChange={(e) => fieldProps.onChange(e.target.value)}
      onBlur={fieldProps.onBlur}
      onFocus={fieldProps.onFocus}
    />
  )}
/>
```

### Checkbox

```tsx
<Field<FormType, 'agree'>
  name="agree"
  render={(fieldProps) => (
    <label>
      <input
        type="checkbox"
        checked={fieldProps.value || false}
        onChange={(e) => fieldProps.onChange(e.target.checked)}
        onBlur={fieldProps.onBlur}
        onFocus={fieldProps.onFocus}
      />
      I agree to the terms
    </label>
  )}
/>
```

### Select Dropdown

```tsx
<Field<FormType, 'country'>
  name="country"
  render={(fieldProps) => (
    <select
      value={fieldProps.value || ''}
      onChange={(e) => fieldProps.onChange(e.target.value)}
      onBlur={fieldProps.onBlur}
      onFocus={fieldProps.onFocus}
    >
      <option value="">Select a country</option>
      <option value="us">United States</option>
      <option value="ca">Canada</option>
      <option value="uk">United Kingdom</option>
    </select>
  )}
/>
```

## Next Steps

Now that you understand the basics, explore these guides:

- [Form API Reference](./form-api) - Learn about all available form methods
- [Field Management](./field-management) - Deep dive into field handling
- [Validation](./validation) - Comprehensive validation guide
- [Watching Values](./watching-values) - How to watch and react to form changes